import{h as e,G as t,H as a,J as s,o as i,c as n,w as l,a as r,d as o,t as d,i as u,K as c,L as h,M as g}from"./index.ca9f02a4.js";import{_ as p}from"./plugin-vue_export-helper.21dcd24c.js";var y=p({data:()=>({categories:[],index:0,newEssay:{title:"",content:"",cid:"",uid:-1}}),onLoad(t){e({url:"/AnonymousForum/GET/Category.php",method:"POST",success:e=>{for(let t in e.data.category)this.categories.push(e.data.category[t].name);this.categories.pop(),""!=t.currentCategory&&(this.index=this.categories.indexOf(t.currentCategory))}})},methods:{categoryPickerChange(e){this.index=e.detail.value},titleBlur(e){this.newEssay.title=e.detail.value},essayBlur(e){this.newEssay.content=e.detail.value},submit(){this.$store.getters.getUid<=-1?t({title:"未登录!",content:"当前未登录,确认以游客身份进行发送吗?",success:e=>{e.cancel}}):this.newEssay.uid=this.$store.getters.getUid,this.newEssay.cid=this.categories[this.index],e({url:"/AnonymousForum/SET/newEssay.php",method:"POST",data:this.newEssay,success:e=>{var i=e.data.details;e.data.state?t({title:"发帖成功",showCancel:!1,success:e=>{a({url:"../details/details?details="+encodeURIComponent(JSON.stringify(i))})}}):t({title:"发帖失败",content:"如有疑问,请将错误相关情况发送至管理员",showCancel:!1,success:e=>{s({})}})}})}}},[["render",function(e,t,a,s,p,y){const f=u,m=c,x=h,_=g;return i(),n(f,{id:"new-essay"},{default:l((()=>[r(f,{id:"pick"},{default:l((()=>[r(f,{id:"pick-text"},{default:l((()=>[o("选择发布板块:")])),_:1}),r(f,{id:"picker"},{default:l((()=>[r(m,{onChange:y.categoryPickerChange,value:p.index,range:p.categories},{default:l((()=>[r(f,null,{default:l((()=>[o(d(p.categories[p.index]),1)])),_:1})])),_:1},8,["onChange","value","range"])])),_:1})])),_:1}),r(f,null,{default:l((()=>[r(x,{id:"title-text",placeholder:"标题,最长20",maxlength:"20",onBlur:y.titleBlur},null,8,["onBlur"])])),_:1}),r(f,null,{default:l((()=>[r(x,{placeholder:"正文,最长500",maxlength:"500","auto-height":"true",onBlur:y.essayBlur},null,8,["onBlur"])])),_:1}),r(f,{id:"btn"},{default:l((()=>[r(_,{onClick:t[0]||(t[0]=e=>y.submit()),type:"primary"},{default:l((()=>[o("发帖")])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-b03ce776"]]);export{y as default};
